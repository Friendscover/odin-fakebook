<h1> Welcome <%= @user.first_name %>! </h1>

<h3> Friends </h3>
<% @send_requests.each do |f| %>
  <% if f.accepted_request %>
    <%= f.friend.first_name %></br>
  <% end %>
<% end %>

<% @recieved_requests.each do |f| %>
  <% if f.accepted_request %>
    <%= f.friend.first_name %></br>
  <% end %>
<% end %>

<h3> Send Requests: </h3>
<% @send_requests.each do |f| %>
  <% next if f.accepted_request %>
  <%= f.friend.first_name %></br>
<% end %>

<h3> Pending Requests: </h3>
<% @recieved_requests.each do |f| %>
  <% next if f.accepted_request %>
  <div>
    <%= link_to f.user.first_name, user_path(f.user_id) %> 
    <%= form_with(url: friendship_path(f.id), method: "patch") do |form| %>
      <%= form.submit "Accept" %>
      <%= form.submit "Decline" %>
    <% end %>
  </div>
<% end %>

<h3>Latest Posts</h3>
<ul>
  <% @posts.each do |post| %>
    <li>
      <%= link_to post.title, post_path(post) %>
    </li>
  <% end %>
</ul>


<h3> Latest Users </h3>
  <div>
    <% @users.each do |u| %>
      <%= link_to u.first_name, user_path(u) %>
      <%= link_to u.last_name, user_path(u) %></br>
      <%= next if @friends.include?(u.id) || current_user.id == u.id %>
        <%= form_with model: [ @user, @user.friendships.build ]  do |form| %>
            <%= form.hidden_field :accepted_request, value: false %>
            <%= form.hidden_field :friend_id, value: u.id %>
            <%= form.submit "Send Friend Request" %>
      <% end %>
    <% end %>
  </div>
</h3>

<h3>
  <div>
    You are currently logged in as <%= @user.first_name %></br>
    <%= link_to "Logout here", destroy_user_session_path, method: :delete %>
  </div>
</h3>
