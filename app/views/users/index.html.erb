<h1> Welcome <%= @user.first_name %>! </h1>

<%= render "shared/friendships", :user => @user %>

<h3> Friend Requests: </h3>

<% @user.friendships.each do |f| %>
  <% if f.accepted_request == false %>
    <div>
      <%= link_to f.friend.first_name, user_path(f.friend_id) %> 
        <%= form_with(url: friendship_path(f.id), method: "patch") do |form| %>
          <%= form.submit "Accept" %>
          <%= form.submit "Decline" %>
        <% end %>
    </div>
  <% end %>
<% end %>

<h3>Latest Posts</h3>

<ul>
  <% @posts.each do |post| %>
    <li>
      <%= link_to post.title, post_path(post) %>
    </li>
  <% end %>
</ul>


<h3> Latest Users </h3>
  <div>
    <% @users.each do |u| %>
      <%= link_to u.first_name, user_path(u) %>
      <%= link_to u.last_name, user_path(u) %></br>
      <% next if @friend_ids.include?(u.id) || @user.id == u.id %>
        <%= form_with model: [ @user, @user.friendships.build ]  do |form| %>
            <%= form.hidden_field :accepted_request, value: false %>
            <%= form.hidden_field :friend_id, value: u.id %>
            <%= form.submit "Send Friend Request" %>
      <% end %>
    <% end %>
  </div>
</h3>

<h3>
  <div>
    You are currently logged in as <%= @user.first_name %></br>
    <%= link_to "Logout here", destroy_user_session_path, method: :delete %>
  </div>
</h3>
